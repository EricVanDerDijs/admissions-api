#!/bin/bash

HOST=""
PORT="3010"
DETACH="-it"
TAG="1"

# Get docker ip addrs
HOST=$(sudo docker network inspect bridge --format='{{(index .IPAM.Config 0).Gateway}}')

if [ "$port" != "" ]
then
  PORT=$port
fi

if [ "$detach" == "true" ]
then
  echo "Running detached"
  DETACH="-d"
fi

if [ "$tag" != "" ]
then
  TAG=$tag
fi

echo "Mapped to port: $PORT"

docker run \
  $DETACH \
  -p $PORT:80 \
  -e HOST=$HOST \
  -e PORT=$PORT \
  --mount source=api-volume-$TAG,destination=/app/storage admissions-api